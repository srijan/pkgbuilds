# Maintainer: Srijan Choudhary <srijan4@gmail.com>
# Contributor: Jeffrey Gelens <jgelens@gmail.com>
pkgname=haproxy
pkgver=1.4.22
pkgrel=2
pkgdesc="The Reliable, High Performance TCP/HTTP Load Balancer"
arch=('i686' 'x86_64')
url="http://haproxy.1wt.eu"
license=('GPL')
depends=('pcre')
makedepends=('gcc>=4.2.0' 'linux-headers')
backup=('etc/haproxy/haproxy.cfg')
install=$pkgname.install
source=(  "http://haproxy.1wt.eu/download/1.4/src/$pkgname-$pkgver.tar.gz"
          "haproxy.init"
          "haproxy.service" )
md5sums=('a0b007c76f6a78524f3b3dd5e704979c'
         '1b761a1024208509f8a00eba9f0b5b27'
         'cd573d865d67f1c7eb6ef38b2ef4f6e1')


build() {
  cd "$srcdir/$pkgname-$pkgver"
  make TARGET=linux2628 USE_PCRE=1
  make PREFIX=$pkgdir/usr install

  install -D -m755 "${startdir}/haproxy.init" "${pkgdir}/etc/rc.d/haproxy"
  install -D -m644 "examples/haproxy.cfg" "${pkgdir}/etc/haproxy/haproxy.cfg"
  install -d "${pkgdir}/usr/share/haproxy"
  for _doc in "doc/haproxy*.txt"; do
    install -D -m644 ${_doc} "${pkgdir}/usr/share/haproxy/"
  done
  install -D -m644 "${startdir}/haproxy.service" "${pkgdir}/usr/lib/systemd/system/haproxy.service"
}

# vim:ts=2:sw=2:et
